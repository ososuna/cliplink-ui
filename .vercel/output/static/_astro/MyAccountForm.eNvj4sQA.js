import{j as e}from"./utils.ag4OtbVb.js";import{o as y,s as i,u as F,F as N,a as m,b as l,e as c,c as d,d as u,t as P}from"./form.JoO0pxNJ.js";import{r as j}from"./index.CWXBSLiN.js";import{A as C,a as v}from"./auth.view-service.impl.BxHa1p8t.js";import"./ui.store.V0UIaDrX.js";import{B as E}from"./button.DlpEXsww.js";import{C as I,a as L,b as T,e as A}from"./card.CfIqYNeu.js";import{I as p}from"./input.BC8Asylz.js";import{u as O}from"./use-service.OG-UkMvg.js";import{u as R}from"./use-toast.D-BVXOBP.js";import"./index.Cxtmh_mJ.js";import"./index.bO9abPB-.js";import"./index.CrMHok4L.js";const B=y({name:i().min(2).max(60),lastName:i().min(2).max(120),email:i().email({message:"Please enter a valid email address"})}),W=({user:a})=>{const[f,h]=j.useState(!1),x=O(v,C),{toast:n}=R();j.useEffect(()=>{const s=new URL(window.location.href);s.searchParams.get("updated")==="true"&&(n({title:"Profile updated ðŸŽ‰",description:"Your profile has been successfully updated"}),s.searchParams.delete("updated"),window.history.replaceState({},document.title,s.toString()))},[n]);const b={name:a.name,lastName:a.lastName,email:a.email},t=F({resolver:P(B),defaultValues:b}),g=async s=>{const r=Object.fromEntries(Object.entries(s).filter(([o,S])=>S!==a[o]));if(Object.keys(r).length===0){n({title:"No changes detected",description:"Please modify at least one field before updating"});return}h(!0);const w=await x.update(r.name,r.lastName,r.email);if(h(!1),w){const o=new URL(window.location.href);o.searchParams.set("updated","true"),window.location.href=o.toString()}};return e.jsxs(I,{children:[e.jsx(L,{children:e.jsx(T,{children:"Edit Profile"})}),e.jsx(A,{children:e.jsx(N,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(g),className:"space-y-4",children:[e.jsx(m,{control:t.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Name"}),e.jsx(d,{children:e.jsx(p,{...s})}),e.jsx(u,{})]})}),e.jsx(m,{control:t.control,name:"lastName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Last name"}),e.jsx(d,{children:e.jsx(p,{...s})}),e.jsx(u,{})]})}),e.jsx(m,{control:t.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Email"}),e.jsx(d,{children:e.jsx(p,{...s})}),e.jsx(u,{})]})}),e.jsx(E,{type:"submit",disabled:f,children:f?"Updating...":"Update Profile"})]})})})]})};export{W as default};
