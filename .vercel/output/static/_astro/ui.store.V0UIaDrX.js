let i=[],u=0;const f=4;let c=n=>{let t=[],e={get(){return e.lc||e.listen(()=>{})(),e.value},lc:0,listen(l){return e.lc=t.push(l),()=>{for(let a=u+f;a<i.length;)i[a]===l?i.splice(a,f):a+=f;let s=t.indexOf(l);~s&&(t.splice(s,1),--e.lc||e.off())}},notify(l,s){let a=!i.length;for(let o of t)i.push(o,e.value,l,s);if(a){for(u=0;u<i.length;u+=f)i[u](i[u+1],i[u+2],i[u+3]);i.length=0}},off(){},set(l){let s=e.value;s!==l&&(e.value=l,e.notify(s))},subscribe(l){let s=e.listen(l);return l(e.value),s},value:n};return e},r=(n={})=>{let t=c(n);return t.setKey=function(e,l){let s=t.value;typeof l>"u"&&e in t.value?(t.value={...t.value},delete t.value[e],t.notify(s,e)):t.value[e]!==l&&(t.value={...t.value,[e]:l},t.notify(s,e))},t};const p=r({message:"",type:""}),v=n=>{n.message&&(n.message=n.message.charAt(0).toUpperCase()+n.message.slice(1)),p.set(n)};export{v as s,p as u};
